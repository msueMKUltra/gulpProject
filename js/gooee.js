"use strict";$(function(){d3.queue().defer(d3.json,"./json/name_map.json").defer(d3.json,"./json/location.json").defer(d3.json,"./json/data_C.json").defer(d3.json,"./json/data_B.json").awaitAll(function(t,e){if(t)throw t;var n={width:1e3,height:1e3},a=d3.select(".box").append("svg").attr("width",n.width).attr("height",n.height).style("border","1px solid slateblue"),r=[],i=d3.scaleLinear().domain([0,100]).range([0,1e3]),o={max:0,start:4,section:4,range:6},c={max:0,start:2,section:4,range:2},d=e[0],s=e[1],u=e[2],l=e[3];for(var f in d)m=d[f],r.push({id:f,name:m});var x=d3.map(r,function(t){return t.id});for(var f in s){var v=s[f][0],g=s[f][1],m=(D=x.get(f)).name;D.location={cx:v,cy:g}}for(var f in u){var h=u[f],m=(D=x.get(f)).name;x.get(f).radius=h,x.get(f).end=[],o.max=h>o.max?h:o.max}var p=d3.range(o.start,o.start+o.section*o.range,o.range),y=d3.scaleQuantize().domain([0,o.max]).range(p);for(var f in l){var j=l[f].start,w=l[f].end,A=l[f].count,N=x.get(j),k=x.get(w),b=k.name,v=k.location.cx,g=k.location.cy;N.end.push({lines:[[N.location.cx,N.location.cy],[v,g]],count:A,id:b}),c.max=A>c.max?A:c.max}for(var z=d3.range(c.start,c.start+c.section*c.range,c.range),Q=d3.scaleQuantize().domain([0,c.max]).range(z),_=d3.scaleQuantize().domain([0,c.max]).range(d3.range(c.section)),C=d3.interpolate("yellowgreen","darkred"),q=d3.drag().on("start",function(t){d3.select(this.parentNode).raise().classed("active",!0)}).on("drag",function(t){var e=d3.select(this.parentNode),n=e.attr("id");d3.select(this).attr("cx",d3.event.x).attr("cy",d3.event.y),e.select("text").attr("x",function(t){return d3.event.x+y(t.radius)}).attr("y",function(t){return d3.event.y-y(t.radius)}),e.selectAll("path").attr("d",function(t){return t.lines[0][0]=i.invert(d3.event.x),t.lines[0][1]=i.invert(d3.event.y),F(t.lines)}),d3.selectAll("."+n).attr("d",function(t){return t.lines[1][0]=i.invert(d3.event.x),t.lines[1][1]=i.invert(d3.event.y),F(t.lines)})}).on("end",function(t){d3.select(this).classed("active",!1)}),B=a.selectAll("g").data(r).enter().append("g").attr("data-code",function(t){return t.id}).attr("id",function(t){return t.name}),L=x.keys(),$=0;$<L.length;$++){var D=x.get(L[$]),E=D.end,b=D.name,F=d3.line().curve(d3.curveCardinal).x(function(t){return i(t[0])}).y(function(t){return i(t[1])});d3.select("#"+b).selectAll("path").data(E).enter().append("path").attr("class",function(t){return t.id}).attr("d",function(t){return F(t.lines)}).attr("stroke",function(t){return C(_(t.count)/(c.section-1))}).attr("stroke-width",function(t){return Q(t.count)})}var G=B.append("circle").attr("cx",function(t){return i(t.location.cx)}).attr("cy",function(t){return i(t.location.cy)}).attr("r",function(t){return y(t.radius)}).call(q);B.append("text").attr("x",function(t){return i(t.location.cx)+y(t.radius)}).attr("y",function(t){return i(t.location.cy)-y(t.radius)}).text(function(t){return t.name}),G.on("mouseover",function(){d3.select(this.parentNode).select("text").text(function(t){return t.name+" ("+t.id+")"})}),G.on("mouseout",function(){d3.select(this.parentNode).select("text").text(function(t){return t.name})}),d3.select("#N8").select("circle").attr("fill","coral")})});
//# sourceMappingURL=gooee.js.map
