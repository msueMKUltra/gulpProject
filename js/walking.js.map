{"version":3,"sources":["walking.js"],"names":["$","scatterPlot","update","data","dataset","selectAll","enter","transition","attr","xScale","x","d","i","yScale","y","rScale","datalength","length","append","duration","svg","classed","location","select","text","split","on","d3","xInter","interpolateRound","yInter","unit","width","padding","unit2","preScale","scaleLinear","yScale2","domain","rScale2","scaleQuantile","oScale2","tween","xAxis2","axisBottom","range","yAxis2","axisRight","t","linePlot","noOneCircle","empty","remove","lineset","trans","exit","f","svg2","p","xScale2","enterPath","linePath","filter","Math","random","node","getTotalLength","pathLength","g2","start","end","push","getRandomData","setInterval","this","pInter","fInter","shift","g","height","yGrid","tickValues","tickFormat","tickSize","scale","call","xGrid","format","xGrid2"],"mappings":"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","file":"walking.js","sourcesContent":["$(function(){\n\tvar dataset = [];\n\tvar lineset = [];\n\tvar duration = 2000;\n\tvar datalength = 5;\n\tvar unit = {width: 300, height: 300, padding: 50}\n\tvar svg = d3.select('.container').append('svg').attr('width', unit.width).attr('height', unit.height)\n\t\t\t\t.append('g').attr('transform', 'translate(' + unit.padding + ',' + unit.padding + ')');\n\tvar xScale = d3.scaleLinear().domain([0, 32]).range([0, unit.width - unit.padding * 2]);\n\tvar yScale = d3.scaleLinear().domain([0, 32]).range([unit.height - unit.padding * 2, 0]);\n\tvar rScale = d3.scaleQuantile().domain(d3.range(datalength + 1)).range([0, 4, 5, 6, 7, 8]);\n\tvar oScale = d3.scaleQuantile().domain(d3.range(datalength + 1)).range([0, 0.3, 0.4, 0.5, 0.6, 0.7]);\n\t// var rScale = d3.scaleQuantize().domain([0, 9]).range(d3.range(10));\n\tvar yGrid = d3.axisBottom().tickValues([2, 9, 16, 23, 30]).tickFormat('').tickSize(unit.height - unit.padding * 2).scale(xScale);\n\tsvg.append('g').classed('y-grid', true).call(yGrid);\n\tvar xGrid = d3.axisRight().tickValues([2, 9, 16, 23, 30]).tickFormat('').tickSize(unit.width - unit.padding * 2).scale(yScale);\n\tsvg.append('g').classed('x-grid', true).call(xGrid);\n\tvar g = svg.append('g').classed('circle-group', true);\n\n\tfunction scatterPlot(){\n\t\tvar update = g.selectAll('circle').data(dataset);\n\t\tvar enter = update.enter();\n\t\tvar exit = update.exit();\n\n\t\tupdate.transition()\n\t\t\t.duration(duration)\n\t\t\t.attr('cx', (d, i) => xScale(d.x))\n\t\t\t.attr('cy', (d, i) => yScale(d.y))\n\t\t\t.attr('r', (d, i) => rScale( datalength - dataset.length + i + 1))\n\t\t\t// .attr('opacity', (d, i) => oScale( datalength - dataset.length + i));\n\t\t\t.attr('opacity', 0.3);\n\n\t\tenter.append('circle')\n\t\t\t.attr('cx', (d, i) => {\n\t\t\t\tif(dataset.length == 1){\n\t\t\t\t\treturn xScale(d.x);\n\t\t\t\t}else{\n\t\t\t\t\treturn xScale(dataset[i - 1].x);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.attr('cy', (d, i) => {\n\t\t\t\tif(dataset.length == 1){\n\t\t\t\t\treturn yScale(d.y);\n\t\t\t\t}else{\n\t\t\t\t\treturn yScale(dataset[i - 1].y);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.attr('r', (d, i) => {\n\t\t\t\tif(dataset.length == 1){\n\t\t\t\t\treturn 0;\n\t\t\t\t}else{\n\t\t\t\t\treturn rScale(i - 1);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.attr('opacity', 0)\n\t\t\t.transition()\n\t\t\t.duration(duration)\n\t\t\t// .ease(d3.easeLinear)\n\t\t\t.attr('cx', (d, i) => xScale(d.x))\n\t\t\t.attr('cy', (d, i) => yScale(d.y))\n\t\t\t.attr('r', (d, i) => rScale((datalength)))\n\t\t\t// .attr('opacity', oScale(datalength))\n\t\t\t.attr('opacity', 0.7)\n\t\t\t.on('start',(d, i) => {\n\t\t\t\tsvg.append('circle')\n\t\t\t\t\t.classed('blink', true)\n\t\t\t\t\t.attr('cx', () => {\n\t\t\t\t\t\tif(dataset.length == 1){\n\t\t\t\t\t\t\treturn xScale(d.x);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\treturn xScale(dataset[i - 1].x);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.attr('cy', () => {\n\t\t\t\t\t\tif(dataset.length == 1){\n\t\t\t\t\t\t\treturn yScale(d.y);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\treturn yScale(dataset[i - 1].y);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.attr('r', 0)\n\t\t\t\t\t.attr('opacity', 1)\n\t\t\t\t\t.transition()\n\t\t\t\t\t.duration(duration)\n\t\t\t\t\t// .ease(d3.easeLinear)\n\t\t\t\t\t.attr('cx', xScale(d.x))\n\t\t\t\t\t.attr('cy', yScale(d.y))\n\t\t\t\t\t.attr('opacity', 0)\n\t\t\t\t\t.attr('r', 30)\n\t\t\t\t\t.on('end', function(){\n\t\t\t\t\t\td3.select(this).remove();\n\t\t\t\t\t});\n\t\t\t\tvar location = svg.select('.location');\n\t\t\t\tif(location.empty()){\n\t\t\t\t\tlocation = svg.append('text').classed('location',true)\n\t\t\t\t\t\t\t\t\t.text('(0, 0)')\n\t\t\t\t\t\t\t\t\t.attr('text-anchor', 'middle')\n\t\t\t\t\t\t\t\t\t.attr('transform','translate(' + (unit.width/2 - unit.padding) + ', 0)')\n\t\t\t\t\t\t\t\t\t.attr('font-size', 40)\n\t\t\t\t\t\t\t\t\t// .attr('opacity', oScale(datalength))\n\t\t\t\t\t\t\t\t\t.attr('opacity', 0.7)\n\t\t\t\t\t\t\t\t\t.attr('dy', -10);\n\t\t\t\t}\n\t\t\t\tvar text = location.text();\n\t\t\t\tvar split = text.split(', ');\n\t\t\t\tvar x = split[0].split('(')[1];\n\t\t\t\tvar y = split[1].split(')')[0];\n\t\t\t\tlocation.transition().duration(duration)\n\t\t\t\t\t\t.tween('xyChange', () => {\n\t\t\t\t\t\t\tvar xInter = d3.interpolateRound(x, d.x);\n\t\t\t\t\t\t\tvar yInter = d3.interpolateRound(y, d.y);\n\t\t\t\t\t\t\treturn function(t) {\n\t\t\t\t\t\t\t    location.text('(' + xInter(t) + ', ' + yInter(t) + ')');\n\t\t\t\t\t\t    }\n\t\t\t\t\t\t});\n\t\t\t});\n\n\t}\n\n\tvar unit2 = {width: 500, height: 300, padding: 50}\n\tvar svg2 = d3.select('.container').append('svg').attr('width', unit2.width).attr('height', unit2.height)\n\t\t\t\t.append('g').attr('transform', 'translate(' + unit2.padding + ',' + unit2.padding + ')');\n\tvar xScale2 = d3.scaleLinear().domain([ 1, datalength]).range([0, unit2.width - unit2.padding * 2]);\n\tvar preScale = d3.scaleLinear().domain([0, 255]).range([0, 1]);\n\tvar yScale2 = d3.scaleLinear().domain([0, 1]).range([unit2.height - unit2.padding * 2, 0]);\n\tvar rScale2 = d3.scaleQuantile().domain(d3.range(datalength)).range([4, 6, 8, 10, 12]);\n\tvar oScale2 = d3.scaleQuantile().domain(d3.range(datalength)).range([0.3, 0.4, 0.5, 0.6, 0.7]);\n\t// var rScale = d3.scaleQuantize().domain([0, 9]).range(d3.range(10));\n\tvar xAxis2 = d3.axisBottom().tickValues(d3.range(1, datalength + 1)).tickFormat(d3.format('d')).scale(xScale2);\n\tsvg2.append('g').classed('x-axis', true).attr('transform', 'translate(' + unit2.padding/2 + ',' + (unit2.height - unit2.padding*2) + ')').call(xAxis2);\n\tvar yAxis2 = d3.axisRight().tickValues(d3.range(0, 1.25, 0.25)).tickSize(0).tickFormat(d3.format('.0%')).scale(yScale2);\n\tsvg2.append('g').classed('y-axis', true).attr('transform', 'translate( -36, -10)').call(yAxis2);\n\tvar xGrid2 = d3.axisRight().tickValues(d3.range(0, 1.25, 0.25)).tickFormat('').tickSize(unit2.width).scale(yScale2);\n\tsvg2.append('g').classed('x-grid', true).attr('transform', 'translate(' + -unit2.padding + ', 0)').call(xGrid2);\n\tvar g2 = svg2.append('g').classed('line-group', true).attr('transform', 'translate(' + unit2.padding/2 + ', 0)');\n\n\tsvg2.append('defs').append('marker')\n\t\t\t.attr('id', 'linePoint')\n\t\t\t.attr('viewBox', '0 0 12 12')\n\t\t\t.attr('refX', '6')\n\t\t\t.attr('refY', '6')\n\t\t\t.attr('markerHeight', '6')\n\t\t\t.attr('markerWidth', '6')\n\t\t\t.attr('orient', 'auto')\n\t\t\t.append('circle')\n\t\t\t.attr('cx', 6)\n\t\t\t.attr('cy', 6)\n\t\t\t.attr('r', 6)\n\t\t\t.attr('fill', 'black');\n\n\tfunction linePlot(){\n\t\tif(dataset.length == 1){\n\t\t\tg2.append('circle').classed('noOneCircle', true).data(dataset)\n\t\t\t\t.attr('cx', (d, i) => xScale2(i + 1))\n\t\t\t\t.attr('cy', (d) => yScale2(preScale(d.f)))\n\t\t\t\t.attr('fill', 'black')\n\t\t\t\t.attr('r', 0)\n\t\t\t\t.attr('opacity', 0)\n\t\t\t\t.transition()\n\t\t\t\t.duration(duration)\n\t\t\t\t.attr('r', 6)\n\t\t\t\t.attr('opacity', 0.5)\n\t\t\t\t.on('start', (d, i) => {\n\t\t\t\t\tsvg2.append('circle')\n\t\t\t\t\t\t.classed('blink', true)\n\t\t\t\t\t\t.attr('cx', () => xScale2(i + 1))\n\t\t\t\t\t\t.attr('cy', () => yScale2(preScale(d.f)))\n\t\t\t\t\t\t.attr('transform', 'translate(' + unit2.padding/2 + ', 0)')\n\t\t\t\t\t\t.attr('r', 0)\n\t\t\t\t\t\t.attr('opacity', 1)\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.duration(duration)\n\t\t\t\t\t\t.attr('opacity', 0)\n\t\t\t\t\t\t.attr('r', 30)\n\t\t\t\t\t\t.on('end', function(){\n\t\t\t\t\t\t\td3.select(this).remove();\n\t\t\t\t\t\t});\n\t\t\t\t\tvar location = svg2.select('.location');\n\t\t\t\t\tif(location.empty()){\n\t\t\t\t\t\tlocation = svg2.append('text').classed('location',true)\n\t\t\t\t\t\t\t\t\t\t.text('0%(0)')\n\t\t\t\t\t\t\t\t\t\t.attr('text-anchor', 'middle')\n\t\t\t\t\t\t\t\t\t\t.attr('transform','translate(' + (unit2.width/2 - unit2.padding) + ', 0)')\n\t\t\t\t\t\t\t\t\t\t.attr('font-size', 40)\n\t\t\t\t\t\t\t\t\t\t// .attr('opacity', oScale(datalength))\n\t\t\t\t\t\t\t\t\t\t.attr('opacity', 0.7)\n\t\t\t\t\t\t\t\t\t\t.attr('dy', -10);\n\t\t\t\t\t}\n\t\t\t\t\tvar text = location.text();\n\t\t\t\t\tvar split = text.split('%');\n\t\t\t\t\tvar p = split[0];\n\t\t\t\t\tvar f = split[1].split('(')[1].split(')')[0];\n\t\t\t\t\tlocation.transition().duration(duration)\n\t\t\t\t\t\t.tween('pfChange', () => {\n\t\t\t\t\t\t\tvar pInter = d3.interpolateRound(p, preScale(d.f*100));\n\t\t\t\t\t\t\tvar fInter = d3.interpolateRound(f, d.f);\n\t\t\t\t\t\t\treturn function(t) {\n\t\t\t\t\t\t\t    location.text(pInter(t) + '%(' + fInter(t) + ')');\n\t\t\t\t\t\t    }\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t}\n\n\t\tvar noOneCircle = d3.select('.noOneCircle');\n\t\tif(!noOneCircle.empty()) noOneCircle.remove();\n\n\t\t// console.log(lineset);\n\n\t\tvar update = g2.selectAll('path').data(lineset);\n\t\tvar enter = update.enter();\n\t\tvar exit = update.exit();\n\n\t\tvar linePath = d3.line().x((d, i) => xScale2(i + 1)).y((d) => yScale2(preScale(d.f)));\n\n\t\tupdate.attr('stroke-dashoffset', 0)\n\t\t\t.attr('stroke', 'black')\n\t\t\t.attr('stroke-width', 2)\n\t\t\t.attr('fill', 'none')\n\t\t\t.transition()\n\t\t\t.duration(duration)\n\t\t\t.attr('transform', (d, i) => {\n\t\t\t\tvar trans = xScale2(i + 1);\n\t\t\t\tif(lineset.length >= datalength){\n\t\t\t\t\tvar trans = xScale2(i);\n\t\t\t\t}\n\t\t\t\treturn 'translate(' + trans + ', 0)';\n\t\t\t});\n\n\t\tvar enterPath = \n\t\t\tenter.append('path')\n\t\t\t.attr('d', d => linePath(d))\n\t\t\t.attr('transform', (d, i) => {\n\t\t\t\tvar trans = xScale2(i + 1);\n\t\t\t\tif(lineset.length >= datalength + 1){\n\t\t\t\t\ttrans = xScale2(datalength);\n\t\t\t\t}\n\t\t\t\treturn 'translate(' + trans + ', 0)';\n\t\t\t})\n\t\t\t.attr('stroke', 'black')\n\t\t\t.attr('stroke-width', 2)\n\t\t\t.attr('fill', 'none')\n\t\t\t.attr('opacity', 0.5)\n\t\t\t.attr('marker-start', 'url(#linePoint)');\n\n\t\tvar pathLength = enterPath.node().getTotalLength();\n\n\t\tenterPath\n\t\t\t.attr('stroke-dasharray', pathLength + ' ' + pathLength)\n\t\t\t.attr('stroke-dashoffset', pathLength)\n\t\t\t.transition()\n\t\t\t.duration(duration)\n\t\t\t.attr('stroke-dashoffset', 0)\n\t\t\t.on('start', (d, i) => {\n\t\t\t\tsvg2.append('circle')\n\t\t\t\t\t.classed('blink', true)\n\t\t\t\t\t.attr('cx', () => xScale2(i + 1))\n\t\t\t\t\t.attr('cy', () => yScale2(preScale(d[1].f)))\n\t\t\t\t\t.attr('transform', () => {\n\t\t\t\t\t\tvar trans = xScale2(2) + unit2.padding/2;\n\t\t\t\t\t\tif(i >= datalength - 1){\n\t\t\t\t\t\t\ttrans = unit2.padding/2;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn 'translate(' + trans + ', 0)';\n\t\t\t\t\t})\n\t\t\t\t\t.attr('r', 0)\n\t\t\t\t\t.attr('opacity', 1)\n\t\t\t\t\t.transition()\n\t\t\t\t\t.duration(duration)\n\t\t\t\t\t.attr('opacity', 0)\n\t\t\t\t\t.attr('r', 30)\n\t\t\t\t\t.on('end', function(){\n\t\t\t\t\t\td3.select(this).remove();\n\t\t\t\t\t});\n\t\t\t\tsvg2.append('circle')\n\t\t\t\t\t.classed('blink', true)\n\t\t\t\t\t.attr('cx', () => xScale2(i + 1))\n\t\t\t\t\t.attr('cy', () => yScale2(preScale(d[1].f)))\n\t\t\t\t\t.attr('transform', () => {\n\t\t\t\t\t\tvar trans = xScale2(2) + unit2.padding/2;\n\t\t\t\t\t\tif(i >= datalength - 1){\n\t\t\t\t\t\t\ttrans = unit2.padding/2;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn 'translate(' + trans + ', 0)';\n\t\t\t\t\t})\n\t\t\t\t\t.attr('r', 0)\n\t\t\t\t\t.attr('opacity', 0)\n\t\t\t\t\t.transition()\n\t\t\t\t\t.duration(duration)\n\t\t\t\t\t.attr('opacity', 0.5)\n\t\t\t\t\t.attr('r', 6)\n\t\t\t\t\t.on('end', function(){\n\t\t\t\t\t\td3.select(this).remove();\n\t\t\t\t\t});\n\t\t\t\tvar location = svg2.select('.location');\n\t\t\t\tif(location.empty()){\n\t\t\t\t\tlocation = svg2.append('text').classed('location',true)\n\t\t\t\t\t\t\t\t\t.text('0%(0)')\n\t\t\t\t\t\t\t\t\t.attr('text-anchor', 'middle')\n\t\t\t\t\t\t\t\t\t.attr('transform','translate(' + (unit2.width/2 - unit2.padding) + ', 0)')\n\t\t\t\t\t\t\t\t\t.attr('font-size', 40)\n\t\t\t\t\t\t\t\t\t// .attr('opacity', oScale(datalength))\n\t\t\t\t\t\t\t\t\t.attr('opacity', 0.7)\n\t\t\t\t\t\t\t\t\t.attr('dy', -10);\n\t\t\t\t}\n\t\t\t\tvar text = location.text();\n\t\t\t\tvar split = text.split('%');\n\t\t\t\tvar p = split[0];\n\t\t\t\tvar f = split[1].split('(')[1].split(')')[0];\n\t\t\t\tlocation.transition().duration(duration)\n\t\t\t\t\t\t.tween('pfChange', () => {\n\t\t\t\t\t\t\tvar pInter = d3.interpolateRound(p, preScale(d[1].f*100));\n\t\t\t\t\t\t\tvar fInter = d3.interpolateRound(f, d[1].f);\n\t\t\t\t\t\t\treturn function(t) {\n\t\t\t\t\t\t\t    location.text(pInter(t) + '%(' + fInter(t) + ')');\n\t\t\t\t\t\t    }\n\t\t\t\t\t\t});\n\t\t\t})\n\t\t\t.filter((d, i) => i >= datalength - 1)\n\t\t\t.attr('transform', (d, i) => {\n\t\t\t\t\treturn 'translate(' + xScale2(datalength - 1) + ', 0)';\n\t\t\t\t});\n\t}\n\n\tfunction getRandomData(){\n\t\tvar x = ~~(Math.random()*32);\n\t\tvar y = ~~(Math.random()*32);\n\t\tvar f = ~~(Math.random()*256);\n\t\tif(dataset.length == datalength + 1){\n\t\t\tdataset.shift(); \n\t\t\tg.selectAll('circle').filter((d, i) => i == 0).remove();\n\t\t}\n\t\tdataset.push({x: x, y: y, f: f});\n\t\tif(lineset.length == datalength){\n\t\t\tlineset.shift(); \n\t\t\tg2.selectAll('path').filter((d, i) => i == 0).remove();\n\t\t}\n\t\tif(dataset.length > 1){\n\t\t\tvar start = dataset[dataset.length-2];\n\t\t\tvar end = dataset[dataset.length-1];\n\t\t\tlineset.push([start, end]);\n\t\t}\n\t\t\n\t\tscatterPlot();\n\t\tlinePlot();\n\t}\n\n\tgetRandomData();\n\tsetInterval(getRandomData, duration);\n\n});\n"]}