{"version":3,"sources":["d3js_ch08.js"],"names":["$","characters","append","attr","rect","svg","selectAll","d3","d","i","text","select","on","data","char","enter","console","log","event","circle","String","fromCharCode","keyCode","pos","dataset","x","drag","this","call","circles","cx","style","g","y","svg2","scaleExtent","zoom","transform","cy","r"],"mappings":"aAAAA,EAAE,WACD,IAAIC,GAAc,IAAK,IAAK,IAAK,KAA7BA,EAAAA,GAAAA,OAAc,QAAUC,OAAK,OAAjCC,KAAA,QAAA,KAAAA,KAAA,SAAA,KAGIC,EAAOC,EAAIC,UAAU,QADrBD,KAAME,GACNH,QAIWF,OAAc,QACxBC,KAAK,IALC,SAAAK,EAMNL,GANM,OAAA,IAMDM,EANC,KAWPC,KAAAA,IAAWJ,IAIAH,KAAUM,QAAU,KAC9BN,KAAK,SACLA,IAGKA,KAAA,KAAA,IATVA,KAAA,KAAA,IAUGQ,KAAO,OAAQC,aACPP,EAAAC,UAAQ,QACjBO,KAAIC,GACJC,QACCb,OAAO,QADRC,KAEK,IAAA,SAAAK,EAAAC,GAAA,OAAA,IAAAA,EAAA,KACJN,KAAO,IAAA,IACPA,KAAA,KAAA,IANFA,KAAA,KAAA,IAQAa,KAAQC,OAAOC,SAThBR,KAWM,SAAAF,GAAA,OAASA,IACdJ,GAAAA,OAAA,QAAAQ,GAAkB,UAAlB,WAZDR,EAAAD,KAAA,OAAA,SAAAK,GAeA,OAAIW,GAbSC,OAAOC,aAAad,GAAGW,MAAMI,SAmBrC,iBAGIC,gBAOJhB,GAAGI,QAAH,WAhBQP,EAAbD,KAAA,OAAA,eAwBIqB,EAAcC,OAAF,UACZC,KAAAA,KAAUA,IACcvB,KAAA,KAAA,KACxBA,KAAA,IAAA,IACAA,KAAA,OAAA,SACAS,GAAOJ,aAAP,WAJOD,GAMJI,OAASgB,MAAAxB,KAAA,OAAU,WANfS,GASJ,YAAQ,WACRD,IAAAA,EAAHJ,GACEJ,QADFwB,MACY,GAXLpB,GAeJI,OAAOgB,MACVX,KAAA,KAAAO,EAAA,IAhBJpB,KAAA,KAAAoB,EAAA,MAsBYX,GAAOJ,WAAP,WACVL,GAAKQ,OAAKgB,MAAAxB,KAAA,OAAA,WAxBZ,IA4BEa,EAAQC,GAAIV,OAAA,OAEZqB,OAXF,OAtBKzB,KAAK,QAAS,KAmCf0B,KAAAA,SAAaC,KAjCZC,MAAM,mBAAoB,YAyC3Bf,EAAQC,GAAIV,OACTI,QAAO,SAAVH,EAAqBC,GAGrBuB,OAAI3B,IAEKO,GAAA,QAAA,cAEXT,GAHF,OAGY,SAAAK,GAAAD,GAAAI,OAAAgB,MACVxB,KAAK,IAAQK,EAAAiB,EAJflB,GAAAW,MAAAO,GA7GDtB,KAAA,IAAAK,EAAAyB,EAAA1B,GAAAW,MAAAe,KAgFKrB,GAAG,MAAO,cAGdsB,EAAK5B,UAAU,QACbO,OAiBSY,EACPU,IAAAA,EAAAA,OAjBFpB,QACAb,OAAO,QACPC,KAAK,IAAK,SAACK,GAAD,OAAOA,EAAEiB,IACnBtB,KAAK,IAAK,SAACK,GAAD,OAAOA,EAAEyB,IACnB9B,KAAK,QAAS,IACdA,KAAK,SAAU,IACfS,GAAG,QAAS,cAGZgB,KAAKF,GAEP,IAKIU,EAAO7B,GAAG6B,OACVD,aAAa,EAAG,KAChBvB,GAAG,OAAQ,SAASJ,GAEpBD,GAAGI,OAAOgB,MAAMxB,KAAK,YAAaI,GAAGW,MAAMmB,aAGvChC,EAAIH,OAAO,KAAK0B,KAAKQ,GAC3B9B,UAAU,UAAUO,OAbLiB,GAAI,IAAKQ,GAAI,IAAKC,EAAG,KAChCT,GAAI,IAAKQ,GAAI,IAAKC,EAAG,KACrBT,GAAI,IAAKQ,GAAI,IAAKC,EAAG,KACrBT,GAAI,IAAKQ,GAAI,IAAKC,EAAG,MAUSxB,QAAQb,OAAO,UACjDC,KAAK,KAAM,SAACK,GAAD,OAAOA,EAAEsB,KACpB3B,KAAK,KAAM,SAACK,GAAD,OAAOA,EAAE8B,KACpBnC,KAAK,IAAK,SAACK,GAAD,OAAOA,EAAE+B,IACnBpC,KAAK,OAAQ","file":"d3js_ch08.js","sourcesContent":["$(function(){\n\tvar characters = ['A', 'S', 'D', 'F'];\n\n\tvar svg = d3.select('body').append('svg').attr('width', 500).attr('height', 500);\n\tvar rect = svg.selectAll('rect')\n\t\t\t\t\t.data(characters)\n\t\t\t\t\t.enter()\n\t\t\t\t\t.append('rect')\n\t\t\t\t\t.attr('x', (d, i) => i * 110 + 10)\n\t\t\t\t\t.attr('y', 50)\n\t\t\t\t\t.attr('width', 100)\n\t\t\t\t\t.attr('height', 70)\n\t\t\t\t\t.attr('rx', 10)\n\t\t\t\t\t.attr('ry', 10)\n\t\t\t\t\t.attr('fill', 'steelblue');\n\tvar text = svg.selectAll('text')\n\t\t\t\t\t.data(characters)\n\t\t\t\t\t.enter()\n\t\t\t\t\t.append('text')\n\t\t\t\t\t.attr('x', (d, i) => i * 110 + 10)\n\t\t\t\t\t.attr('y', 50)\n\t\t\t\t\t.attr('dx', 10)\n\t\t\t\t\t.attr('dy', 20)\n\t\t\t\t\t.attr('fill', 'ivory')\n\t\t\t\t\t.text((d) => d);\n\td3.select('body').on('keydown', function(){\n\t\trect.attr('fill', function(d) {\n\t\t\tvar char = String.fromCharCode(d3.event.keyCode)\n\t\t\tif( d == char){\n\t\t\t\treturn 'lightsteelblue';\n\t\t\t}else{\n\t\t\t\treturn 'steelblue';\n\t\t\t}\n\t\t});\n\t\tconsole.log(d3.event);\n\n\t}).on('keyup', function(){\n\t\trect.attr('fill', 'steelblue');\n\t});\n\n\tvar circle = svg.append('circle')\n\t\t\t\t\t.attr('cx', 50)\n\t\t\t\t\t.attr('cy', 200)\n\t\t\t\t\t.attr('r', 40)\n\t\t\t\t\t.attr('fill', 'coral')\n\t\t\t\t\t.on('touchstart', function(){\n\t\t\t\t\t\td3.select(this).attr('fill', 'khaki');\n\t\t\t\t\t})\n\t\t\t\t\t.on('touchmove', function(){\n\t\t\t\t\t\tvar pos = d3.touches(this)[0]; // 取得第一個觸控點\n\t\t\t\t\t\tconsole.log(pos);\n\t\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t\t.attr('cx', pos[0]) // 觸控點的x座標\n\t\t\t\t\t\t\t.attr('cy', pos[1]); // 觸控點的y座標\n\t\t\t\t\t})\n\t\t\t\t\t.on('touchend', function(){\n\t\t\t\t\t\td3.select(this).attr('fill', 'coral');\n\t\t\t\t\t});\n\n\tvar svg2 = d3.select('div')\n\t\t\t\t\t.append('svg')\n\t\t\t\t\t.attr('width', 300)\n\t\t\t\t\t.attr('height', 300)\n\t\t\t\t\t.style('background-color', 'seashell');\n\tvar dataset = [ { x: 200, y: 100}];\n\tvar drag = d3.drag()\n\t\t\t\t.subject(function(d, i){ // v3. d3.behavior.drag().origin => v4. d3.drag().subject\n\t\t\t\t\t// return {x: d.x, y: d.y}\n\t\t\t\t\t// return {x: 10, y: 20}\n\t\t\t\t\treturn d;\n\t\t\t\t})\n\t\t\t\t.on('start', function(){\n\t\t\t\t\tconsole.log('start');\n\t\t\t\t})\n\t\t\t\t.on('drag', function(d){\n\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t.attr('x', d.x = d3.event.x)\n\t\t\t\t\t\t.attr('y', d.y = d3.event.y);\n\t\t\t\t\tconsole.log(d3.event);\n\t\t\t\t})\n\t\t\t\t.on('end', function(){\n\t\t\t\t\tconsole.log('end');\n\t\t\t\t});\n\tsvg2.selectAll('rect')\n\t\t.data(dataset)\n\t\t.enter()\n\t\t.append('rect')\n\t\t.attr('x', (d) => d.x)\n\t\t.attr('y', (d) => d.y)\n\t\t.attr('width', 50)\n\t\t.attr('height', 50)\n\t\t.on('click', function(){\n\t\t\tconsole.log(d3.mouse(this));\n\t\t})\n\t\t.call(drag);\n\n\tvar circles = [{ cx: 150, cy: 200, r: 30},\n\t\t\t\t\t{ cx: 220, cy: 200, r: 30},\n\t\t\t\t\t{ cx: 150, cy: 270, r: 30},\n\t\t\t\t\t{ cx: 220, cy: 270, r: 30}];\n\n\tvar zoom = d3.zoom()\n\t\t\t\t.scaleExtent([1, 10])\n\t\t\t\t.on('zoom', function(d){\n\t\t\t\t\tconsole.log(d3.event.transform);\n\t\t\t\t\td3.select(this).attr('transform', d3.event.transform);\n\t\t\t\t});\n\n\tvar g = svg.append('g').call(zoom);\n\tg.selectAll('circle').data(circles).enter().append('circle')\n\t\t.attr('cx', (d) => d.cx)\n\t\t.attr('cy', (d) => d.cy)\n\t\t.attr('r', (d) => d.r)\n\t\t.attr('fill', 'teal');\n\t\t\t\t\t\n\n});"]}