"use strict";$(function(){d3.queue().defer(d3.json,"./json/gooee/name_map.json").defer(d3.json,"./json/gooee/data_C.json").defer(d3.json,"./json/gooee/data_B.json").awaitAll(function(t,e){function n(t){return function(e){var n=180*e.midAngle/Math.PI,a="rotate("+n+")translate( 0,"+-1*(d.total+t)+")";return n>120&&n<240&&(a+="rotate(180)"),a}}function a(t,e){return function(n,a){O.selectAll(".innerPath").filter(function(t){return t.source.index!=a&&t.target.index!=a}).transition().style("opacity",t);var r=d3.select(this.parentNode);if(e){var o=n.name;r.select(".codeText").transition().attr("opacity",1),d3.select("#"+o).selectAll("path").attr("fill","none").transition().delay(function(t,e){return 200*(e+1)}).attr("fill",function(t,e){return w(e/(d.section-1))})}else r.select(".codeText").transition().attr("opacity",0)}}if(t)throw t;var r={width:1e3,height:1e3},o=d3.select("svg").attr("width",r.width).attr("height",r.height).style("background-color","white"),i=[],d={max:0,inner:300,outer:310,section:4,space:4},s=(d.outer-d.inner+d.space)*d.section+d.inner;d.total=s;var l={max:0,start:2,section:4,range:2},c=e[0],u=e[1],p=e[2],g=[],m=0;for(var f in c)v=c[f],i.push({code:f,name:v,index:m}),g.push(v),m++;var h=d3.map(i,function(t){return t.code});for(var f in u){var x=u[f],v=h.get(f).name;h.get(f).radius=x,h.get(f).end=[],d.max=x>d.max?x:d.max}for(var A=d3.range(d.section),y=d3.scaleQuantize().domain([0,d.max]).range(A),w=d3.interpolate("cornflowerblue","mistyrose"),j=new Array(g.length),m=0;m<j.length;m++){j[m]=[];for(var P=0;P<j.length;P++)j[m][P]=0}for(var f in p){var b=p[f].start,k=p[f].end,R=p[f].count,T=h.get(b),_=h.get(k);j[_.index][T.index]=R,T.end.push({name:_.name,count:R}),l.max=R>l.max?R:l.max}var z=d3.range(l.section),Q=d3.scaleQuantize().domain([0,l.max]).range(z),q=d3.interpolate("yellowgreen","darkred"),B=d3.chord().padAngle(.03).sortSubgroups(d3.descending),C=d3.arc().innerRadius(d.inner).outerRadius(d.total),I=d3.ribbon().radius(d.inner),M=o.append("g").attr("transform","translate("+r.width/2+","+r.height/2+")").datum(B(j)),N=M.append("g"),O=M.append("g"),S=d3.map(i,function(t){return t.index});B(j).groups.map(function(t){for(var e=t.index,n=S.get(e),a=n.radius,r=n.name,o=n.code,i=y(a),s=N.append("g").attr("id",r).attr("data-code",o),l=0;l<=i;l++){var c=[{startAngle:t.startAngle,endAngle:t.endAngle}],u=d.outer-d.inner,p=d.inner+(d.space+u)*l,g=d.outer+(d.space+u)*l,m=d3.arc().innerRadius(p).outerRadius(g);s.append("g").selectAll("path").data(c).enter().append("path").classed("levelPath",!0).attr("d",m).attr("fill","none").transition().delay(200*(l+1)).attr("fill",w(l/(d.section-1)))}});var $=N.selectAll(".outerPath").data(function(t){return t.groups}).enter().append("g").classed("outerPath",!0);$.append("path").classed("radiusPath",!0).style("fill","transparent").attr("d",C),$.append("text").classed("nameText",!0).attr("dy",".35em").each(function(t,e){t.midAngle=(t.startAngle+t.endAngle)/2,t.name=g[e]}).attr("transform",n(10)).attr("text-anchor","middle").text(function(t){return t.name}),$.append("text").classed("codeText",!0).attr("dy",".35em").each(function(t,e){t.midAngle=(t.startAngle+t.endAngle)/2,t.name=g[e]}).attr("transform",n(36)).attr("text-anchor","middle").text(function(t,e){return S.get(e).code}).attr("opacity",0),O.selectAll(".innerPath").data(function(t){return t}).enter().append("path").classed("innerPath",!0).attr("fill",function(t){return q(Q(t.target.value)/(l.section-1))}).attr("d",I).attr("stroke",function(t){return q(Q(t.target.value)/(l.section-1))}).attr("stroke-width",2).attr("opacity",.7),N.selectAll(".radiusPath").on("mouseover",a(.1,!0)).on("mouseout",a(.7,!1)),d3.selectAll(".nameOuter").on("mouseover",null)})});
//# sourceMappingURL=chord_diagram.js.map
