{"version":3,"sources":["d3js_ch07.js"],"names":["$","yScale","circleUpdate","g","selectAll","data","center","circleExit","transition","duration","exit","drawAxis","xAxis","d3","yAxis","axisLeft","svg2","xScale","attr","d","update","append","Math","random","remove","svg","select","insert","easing","symbol","easeSin","rect","trans","easePoly","path","easeBack","size","text","initx","textTran","node","delay","interpolateRgb","dataset","enter","type","symbolCircle","i","ease","initText","this","t","log","floor","Number","console","setTimeout","scaleLinear","axisBottom","domain","easeBounce","filter","range","on","drawCircle","circleEnter","call","click","push","pop","ticks"],"mappings":"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","file":"d3js_ch07.js","sourcesContent":["$(function(){\n\tvar svg = d3.select('body').insert('svg', '.btn-group').attr('width', 500).attr('height', 500);\n\tvar easing = [\n\t\td3.easeElastic,\n\t\td3.easeBounce,\n\t\td3.easeLinear,\n\t\td3.easeSin,\n\t\td3.easeQuad,\n\t\td3.easeCubic,\n\t\td3.easePoly,\n\t\td3.easeCircle,\n\t\td3.easeExp,\n\t\td3.easeBack\n\t];\n\tvar symbol = d3.symbol().size(400);\n\t// 因為append完的selection，和加入transition的會是不同的物件，所以可以把這兩個分開，用不同的變數存起來\n\tvar rect = svg.append('rect')\n\t\t\t\t\t.attr('width', 300)\n\t\t\t\t\t.attr('height', 300)\n\t\t\t\t\t.attr('fill', 'red');\n\tvar trans = rect.transition()\n\t\t\t\t\t.ease(d3.easePoly)\n\t\t\t\t\t.duration(2000)\n\t\t\t\t\t.delay(500)\n\t\t\t\t\t.attrTween(\"fill\", function() {\n\t\t\t\t\t\treturn d3.interpolateRgb(\"red\", \"blue\");\n\t\t\t\t\t})\n\t\t\t\t\t.attr('height', 700);\n\tvar path = svg.selectAll('path').data(easing).enter().append('path')\n\t\t\t\t\t.attr('d', symbol.type(d3.symbolCircle)).attr('fill', 'mistyrose').attr('transform', (d, i) => 'translate( 50, 50)' + 'translate( 0,' + i * 40 + ')')\n\t\t\t\t\t.transition().duration(2000).delay( (d, i) => i*200 ).ease(d3.easeBack)\n\t\t\t\t\t.attr('transform', (d, i) => 'translate( 50, 50)' + 'translate( 100,' + i * 40 + ')');\n\tvar text = svg.append('text').attr('fill', 'white').attr('x', 100).attr('y', 10).attr('dy', '1.2em').attr('text-anchor', 'end').text(100);\n\tvar initx = text.attr('x');\n\tvar initText = text.text();\n\tvar textTran = text.transition()\n\t\t\t\t\t\t.duration(2000)\n\t\t\t\t\t\t.tween('text', function(){\n\t\t\t\t\t\t\tvar node = this; // this 要先存起來\n\t\t\t\t\t\t\treturn function(t){\n\t\t\t\t\t\t\t\td3.select(node)\n\t\t\t\t\t\t\t\t\t.attr('x', Number(initx) + t * 300)\n\t\t\t\t\t\t\t\t\t.text(Math.floor(Number(initText) + t * 300))\n\t\t\t\t\t\t\t\t\t.attr('fill', 'rgb(' + Math.floor((1 - t) * 255) + ', ' + Math.floor((1 - t) * 255) + ', ' + Math.floor((1 - t) * 255) + ')');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\tvar dataset = [100, 100, 100];\n\tvar g = svg.append('g');\n\tvar rect = g.selectAll('rect')\n\t\t\t\t.data(dataset)\n\t\t\t\t.enter()\n\t\t\t\t.append('rect')\n\t\t\t\t.attr('fill', 'slateblue')\n\t\t\t\t.attr('id', (d, i) => 'rect' + i)\n\t\t\t\t.attr('x', 10)\n\t\t\t\t.attr('y', (d, i) => 10 + i * 35)\n\t\t\t\t.attr('width', (d, i) => d)\n\t\t\t\t.attr('height', 30);\n\tg.transition().duration(2000).select('#rect1').attr('width', 400);\n\tg.transition().duration(2000).selectAll('rect').attr('width', 300).transition().duration(2000).filter( (d,i) => i >= 1).attr('width', 200);\n\t// g.transition().duration(2000).selectAll('rect').filter( (d,i) => i >= 1).attr('width', 200);\n\tg.transition().duration(2000).selectAll('rect').on('start', function(){ console.log('start');}).on('end', function(){ console.log('end');}).attr('width', 300); // v3. each => v4. on\n\tg.transition().duration(2000).selectAll('rect').on('interrupt', function(d, i){ console.log('interrupt');}).attr('width', 300);\n\tsetTimeout(function(){ g.transition().selectAll('rect').attr('width', 10)}, 1000);\n\tvar xScale = d3.scaleLinear().domain([0, 10]).range([0, 300]);\n\tvar xAxis = d3.axisBottom(xScale);\n\tvar g = svg.append('g').attr('class', 'axis').attr('transform', 'translate(50, 200)').call(xAxis);\n\txScale.domain([0, 50]);\n\tg.transition().ease(d3.easeBounce).duration(2000).call(xAxis);\n\n\tvar center = [[0.5, 0.5], [0.7, 0.8], [0.4, 0.9], [0.11, 0.32], [0.88, 0.25], [0.75, 0.12], [0.5, 0.1], [0.2, 0.3], [0.4, 0.1], [0.6, 0.7]];\n\tvar svg2 = d3.select('body').append('svg').attr('width', 500).attr('height', 500);\n\tvar xScale = d3.scaleLinear().domain([0, 1]).range([0, 300]);\n\tvar yScale = d3.scaleLinear().domain([0, 1]).range([300, 0]);\n\tvar g = svg2.append('g').attr('transform', 'translate(30, 30)');\n\tfunction drawCircle(){\n\t\tvar circleUpdate = g.selectAll('circle').data(center);\n\t\tvar circleEnter = circleUpdate.enter();\n\t\tvar circleExit = circleUpdate.exit();\n\t\tcircleUpdate.transition()\n\t\t\t\t\t.duration(2000)\n\t\t\t\t\t.attr('cx', function(d){\n\t\t\t\t\t\treturn xScale(d[0]);\n\t\t\t\t\t})\n\t\t\t\t\t.attr('cy', function(d){\n\t\t\t\t\t\treturn yScale(d[1]);\n\t\t\t\t\t});\n\t\tcircleEnter.append('circle').attr('fill', 'balck').attr('cx', 0).attr('cy', 300).attr('r', 7)\n\t\t\t\t\t.transition().duration(2000).attr('cx', (d) => xScale(d[0])).attr('cy', (d) => yScale(d[1]));\n\t\tcircleExit.transition().duration(2000).attr('fill', 'white').remove();\n\t}\n\tfunction drawAxis(){\n\t\tvar xAxis = d3.axisBottom(xScale).ticks(5);\n\t\tvar yAxis = d3.axisLeft(yScale).ticks(5);\n\t\tsvg2.append('g').attr('class', 'axis').attr('transform', 'translate(30, 330)').call(xAxis);\n\t\tsvg2.append('g').attr('class', 'axis').attr('transform', 'translate(30, 30)').call(yAxis);\n\t}\n\tfunction update(){\n\t\tfor (var i = center.length - 1; i >= 0; i--) {\n\t\t\tcenter[i][0] = Math.random();\n\t\t\tcenter[i][1] = Math.random();\n\t\t}\n\t\tdrawCircle();\n\t}\n\tfunction add(){\n\t\tcenter.push([ Math.random(), Math.random()]);\n\t\tdrawCircle();\n\t}\n\tfunction sub(){\n\t\tcenter.pop();\n\t\tdrawCircle();\n\t}\n\t$('.roller-btn1').click(update);\n\t$('.roller-btn2').click(add);\n\t$('.roller-btn3').click(sub);\n\tdrawCircle();\n\tdrawAxis();\n});"]}